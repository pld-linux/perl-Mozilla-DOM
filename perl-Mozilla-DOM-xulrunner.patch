--- Mozilla-DOM-0.20/Makefile.PL.orig	2005-09-28 21:12:34.000000000 +0200
+++ Mozilla-DOM-0.20/Makefile.PL	2007-06-02 19:44:14.667945893 +0200
@@ -13,6 +13,7 @@
 my $mozpkg = 'mozilla-xpcom';
 my $ffpkg  = 'firefox-xpcom';
 my $mffpkg = 'mozilla-firefox-xpcom';
+my $xulpkg = 'xulrunner-xpcom';
 
 our %build_reqs = (
     'perl-ExtUtils-Depends'   => '0.205',
@@ -20,6 +21,7 @@
     $mozpkg                   => '1.7',
     $ffpkg                    => '1.0',
     $mffpkg                   => '1.0',
+    $xulpkg                   => '1.8',
 );
 
 unless (eval "use ExtUtils::Depends '$build_reqs{'perl-ExtUtils-Depends'}';"
@@ -38,7 +40,8 @@
 
 my %pkgcfg = ExtUtils::PkgConfig->find("$mozpkg >= " . $build_reqs{$mozpkg},
                                        "$ffpkg >= " . $build_reqs{$ffpkg},
-                                       "$mffpkg >= " . $build_reqs{$mffpkg});
+                                       "$mffpkg >= " . $build_reqs{$mffpkg},
+                                       "$xulpkg >= " . $build_reqs{$xulpkg});
 
 my ($pkg) = $pkgcfg{pkg} =~ /^(\S+-xpcom)/;
 
@@ -59,7 +62,7 @@
 # -I/usr/include/mozilla/string -I/usr/include/mozilla/nspr
 $mozdom->set_inc($pkgcfg{cflags}, '-I.', '-I./build',
                  "-I$incdir", "-I$incdir/dom", "-I$incdir/webbrwsr",
-                 "-I$incdir/content", "-I$incdir/docshell");
+                 "-I$incdir/content", "-I$incdir/docshell", "-I$incdir/necko");
 # -L/usr/lib/mozilla -lxpcom -lplds4 -lplc4 -lnspr4 -ldl -lc -lpthread
 $mozdom->set_libs($pkgcfg{libs});
 
--- Mozilla-DOM-0.20/xs/DOM.xs.orig	2005-09-29 04:15:06.000000000 +0200
+++ Mozilla-DOM-0.20/xs/DOM.xs	2007-06-02 20:14:05.181981474 +0200
@@ -12670,8 +12670,9 @@
 	nsIDOMNSHTMLDocument *nshtmldocument;
     PREINIT:
 	nsIDOMDocument * _retval;
+	nsCString contenttype;
     CODE:
-	nshtmldocument->Open(&_retval);
+	nshtmldocument->Open(contenttype, PR_FALSE, &_retval);
 	RETVAL = _retval;
     OUTPUT:
 	RETVAL
